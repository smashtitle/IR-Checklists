## Authentication
- [ ] 4624: Successful logon. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4624)
	- LogonType 3 and 10 are indicators of remote access
	- LogonType 3 and LogonProcess "NtLmSsp" may indicate an NTLM relay attack (correlate source IP with Event ID 8004 to find mismatches, check for Anonymous Logon user)
    - LogonType 9 and Logon Process "seclogo" are common indicators of Pass-the-Hash

| LogonType | Description                                                                                                                                                                                                                                                                |
| --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2         | Console/Interactive (most commonly occurs when a user physically signs in, but may also be seen with a server KVM or VNC)                                                                                                                                                  |
| 3         | Network (ex: a user accesses a file share, a vuln scanner auths to perform checks, an admin is remotely using PS, or an attacker uses PsExec to run a payload on a remote system)                                                                                          |
| 4         | Batch (Scheduled Tasks): non-interactive                                                                                                                                                                                                                                   |
| 5         | Windows Services: non-interactive                                                                                                                                                                                                                                          |
| 7         | Screen Lock/Unlock (can include RDP unlock/reconnect)                                                                                                                                                                                                                      |
| 8         | Network (Cleartext Logon). May indicate a downgrade attack or older admin tool                                                                                                                                                                                             |
| 9         | Alternate Credentials Specified (The caller cloned its current token and specified new credentials for outbound connections. RunAs with /netonly flag, CreateProcessWithLogonW using the LOGON_NETCREDENTIALS_ONLY flag, or LogonUserW with LOGON32_LOGON_NEW_CREDENTIALS) |
| 10        | Remote Interactive (RDP: a user logged on to this computer remotely using Terminal Services or Remote Desktop)                                                                                                                                                             |
| 11        | Cached Credentials (e.g. Offline DC: a user physically logged on to the computer and the computer used domain credentials stored locally for authentication)                                                                                                               |
| 12        | Cached Remote Interactive (RDP, similar to Type 10). Now also seen more often when Microsoft Live accounts are used for auth on standalone workstations                                                                                                                    |
| 13        | Cached Unlock (Similar to Type 7)                                                                                                                                                                                                                                          |
- [ ] 4625: Unsuccessful logon, may indicate brute force or password spraying. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625)

| Logon Error Code | Description                                                                                                               |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------- |
| 0x6              | Invalid/non-existent user account. This can also be caused by replication issues between Active Directory servers.        |
| 0x7              | Requested server not found. This can also be caused by replication issues between Active Directory servers.               |
| 0xC              | Policy restriction prohibited logon; client system restricted from accessing resource or restricted based on time/date.   |
| 0x12             | Account locked, disabled, or expired.                                                                                     |
| 0x17             | Expired password.                                                                                                         |
| 0x18             | Invalid password.                                                                                                         |
| 0x25             | Clock values between server and client are skewed too greatly; Kerberos relies on a timing system to invalidate old TGTs. |
| 0xC0000064       | Non-existent account username                                                                                             |
| 0xC000006A       | Incorrect password (username correct)                                                                                     |
| 0xC000006F       | Account not allowed to log on at this time                                                                                |
| 0xC0000070       | Account not allowed to log on from this computer                                                                          |
| 0xC0000071       | Expired password                                                                                                          |
| 0xC0000072       | Disabled account                                                                                                          |
| 0xC0000193       | Expired account                                                                                                           |
| 0xC0000234       | Account locked                                                                                                            |

- [ ] 4648: Logon with explicit credentials (RunAs, SchTasks, Pass-the-Hash, WinRM, SMB). May appear when an NTLM relayed session is used to create a service/task. Useful with 4624 (successful logon)/4634 (logoff completed) for reconstructing interactive or service logons. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4648)
- [ ] 4649: Kerberos replay attack was detected, alerts when a copied ticket is reused. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4649)
- [ ] 4672: Special privileges assigned to new logon (detects admin or SYSTEM-equivalent sessions at logon time). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4672)
- [ ] 4768: Kerberos TGT request (consider Pass-the-Ticket, Golden TGT attacks). Requests from a non-interactive source prior to 4769 may indicate ticket replay or Pass-the-Ticket staging. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4768)
- [ ] 4740: A user account was locked out, pair with 4625 and related IPs during investigation. Review CallComputerName. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4740)
- [ ] 4771: Kerberos pre-auth failed, may indicate password spraying. Pivot on ClientAddress. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4771)
- [ ] 4776: NTLM credential validation, captures fall-back NTLM use. Note WorkstationName (does it list the client? If not, this may be NTLM coercion). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4776)
- [ ] 8003: Logs failed/blocked NTLM attempts. Appearing prior to 4624/4776 may indicate unsuccessful coercion probes. Security
- [ ] 8004: Successful NTLM auth, has ClientIP, ServerName, and User. Check for authentications where Client IP doesn't correlate to the workstation recorded in 4624. Security [Varonis](https://www.varonis.com/blog/investigate-ntlm-brute-force) [MS Learn on Configuration](https://learn.microsoft.com/en-us/defender-for-identity/deploy/configure-windows-event-collection#configure-ntlm-auditing)
- [ ] 18456: MS SQL Server failed login audit. MSSQLSERVER\Application [MS Learn](https://learn.microsoft.com/en-us/sql/relational-databases/errors-events/mssqlserver-18456-database-engine-error?view=sql-server-ver17#login-failed-for-user-username-or-login-failed-for-user-domainusername)
## Detection
- [ ] Sysmon 2: A process changed a file creation time. This may be noisy, as processes legitimately perform this action during install time. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-12-registryevent-object-create-and-delete)
- [ ] Sysmon 28: FileBlockShredding, generated when Sysmon detects and blocks file shredding from tools like SDelete.exe. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-12-registryevent-object-create-and-delete)
- [ ] 100: An NTLM sign-in failure occurred for an account that is in the Protected Users security group. Microsoft-Windows-Authentication/ProtectedUserFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos#BKMK_ErrorandEvents)
- [ ] 101: NTLM usage attempted. Microsoft-Windows-Authentication/AuthenticationPolicyFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos#BKMK_ErrorandEvents)
- [ ] 104: The security package on the client does not contain the credentials. Microsoft-Windows-Authentication/ProtectedUserFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group#event-logs)
- [ ] 105: Kerberos authentication from a particular device was not permitted. Microsoft-Windows-Authentication/AuthenticationPolicyFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos#BKMK_ErrorandEvents)
- [ ] 106: The user or device was not allowed to authenticate to the server. Microsoft-Windows-Authentication/AuthenticationPolicyFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos#BKMK_ErrorandEvents)
- [ ] 303: A Kerberos ticket-granting-ticket (TGT) was successfully issued for a member of the Protected User group. Microsoft-Windows-Authentication/ProtectedUserFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group#event-logs)
- [ ] 305: Kerberos TGT request did not meet access control restrictions. Microsoft-Windows-Authentication/AuthenticationPolicyFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos#BKMK_ErrorandEvents)
- [ ] 306: User, device or both do not meet the access control restrictions. Microsoft-Windows-Authentication/AuthenticationPolicyFailures-DomainController [MS Learn](https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos#BKMK_ErrorandEvents)
- [ ] 1001: Application Crash Report (Windows Error Reporting) logged alongside Event ID 1000 with details. Application [MS Learn](https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/troubleshoot-application-service-crashing-behavior)
- [ ] 1002: Application hang, may occur if a TA tool fails to execute as expected. Application
- [ ] 1003: Application error, ie, a threat actor's tool triggered a Windows Error Reporting fault. Application [MS Learn](https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/troubleshoot-application-service-crashing-behavior)
- [ ] 1006: The anti-malware engine found malware or other potentially unwanted software. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1006)
- [ ] 1007: The anti-malware platform performed an action to protect your system from malware or other potentially unwanted software. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1007)
- [ ] 1008: The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1008)
- [ ] 1024: RDP connection attempt. Microsoft-Windows-TerminalServices-RDPClient/Operational
- [ ] 1025: RDP connection made. Microsoft-Windows-TerminalServices-RDPClient/Operational
- [ ] 1102: RDP multi-transport connection attempt. Microsoft-Windows-TerminalServices-RDPClient/Operational
- [ ] 1103: RDP multi-transport connection made. Microsoft-Windows-TerminalServices-RDPClient/Operational
- [ ] 1116: Malware detected. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1116)
- [ ] 1117: Remediation action succeeded (file quarantined, process terminated, etc). Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1117)
- [ ] 1118: Remediation action failed. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1118)
- [ ] 1119: The anti-malware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1119)
- [ ] 1121: Attack service reduction rule fired in Block mode, exploit technique prevented. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1121)
- [ ] 1123: Controlled Folder Access blocked untrusted write (anti‑ransomware).  Check for ransomware indicators. This is a Microsoft Defender for Endpoint feature. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/evaluate-controlled-folder-access)
- [ ] 1126: Network Protection blocked outbound connection to known malicious domain/IP. Note DestinationUrl, DestinationIp, and ProcessName. This is a Microsoft Defender for Endpoint feature. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/evaluate-network-protection#review-network-protection-events-in-windows-event-viewer)
- [ ] 1644: LDAP Search diagnostic event, logs details of every LDAP query run on a DC (disabled by default). Microsoft-Windows-ActiveDirectory-DomainService/NTDS General [MS Learn](https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/component-updates/directory-services-component-updates#BKMK_1644)
- [ ] 1917: The shadow copy backup for Active Directory Domain Services was successful. Indicates successful ntds.dit backup, often a prelude to AD credential extraction. Microsoft-Windows-ActiveDirectory-DomainService/NTDS General [MS Learn](https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/#:~:text=Event%20ID%201917,domain%20controller)
- [ ] 4723: Attempted password change. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4723)
- [ ] 5013: Tamper protection blocked an unauthorized change. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-5013)
- [ ] 5152: Windows Filtering Platform blocked a packet (IP‑layer). Prefer 5157 when they're both available as its per-connection. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5152)
- [ ] 5157: Windows Filtering Platform blocked a connection (transport‑layer). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5157)
- [ ] 6273: Network Policy Server denied access to a user. Large numbers of Reason 16 or 23 from the same IP or MAC indicates bruting of WiFi, VPN, 802.1x portals. Repeat denials for privileged accounts should be investigated. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-network-policy-server)
- [ ] 6276: Network Policy Server quarantined a user. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-network-policy-server)
- [ ] 6279: Network Policy Server locked the user account due to repeated failed authentication attempts. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-network-policy-server)
- [ ] 7031: Service terminated unexpectedly. System
- [ ] 8004: AppLocker prevented an executable/DLL from running. Microsoft-Windows-AppLocker/EXE and DLL [MS Learn](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/using-event-viewer-with-applocker)
- [ ] 8007: File was prevented from running (MSI and scripts). Microsoft-Windows-AppLocker/MSI and Script [MS Learn](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/using-event-viewer-with-applocker)
- [ ] 8022: File was prevented from running. ## Microsoft-Windows-AppLocker/Packaged app-Execution [MS Learn](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/using-event-viewer-with-applocker)
- [ ] 8025: File was prevented from running. AppLocker/Packaged app deployment. Microsoft-Windows-AppLocker/Packaged app-Deployment [MS Learn](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/using-event-viewer-with-applocker)
## Initial Compromise
- [ ] Sysmon 3: Network connection, may indicate outbound HTTP/S or staging beacon traffic. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-3-network-connection)
- [ ] Sysmon 8: CreateRemoteThread. Detects some process‑injection methods. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-8-createremotethread)
- [ ] Sysmon 11: FileCreate. Logs creation/overwrite, may indicate payload or tool staging. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-11-filecreate)
- [ ] 1: Triggers when you mount a VHD. Microsoft-Windows-Sysmon/Operational
- [ ] 21: Remote desktop services: shell start. Occurs when a user successfully establishes a session and the shell starts, confirming a successful interactive logon.
- [ ] 1149: RDP user auth succeeded, combine with EID4624/4625 to track lateral movement. Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational
- [ ] 4627: Group membership information, shows the full AD group list for every successful logon (useful to detect changes in privileges). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4627)
- [ ] 5154: WFP permitted an application to listen on a port. Detects unexpected services binding, often precedes C2 beaconing. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5154)
- [ ] 7040: Service start-type change. Threat actors may update critical services (ie, BITS, AV) to Auto or Disabled. System [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc756386(v=ws.10))
## Reconnaissance / Staging
- [ ] Sysmon 16: Sysmon configuration changed. May be an indicator of an attacker attempting to reduce visibility prior to staging a payload. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-16-serviceconfigurationchange) 
- [ ] 12: Indicates an ISO/VHD mount, may indicate payload staging. Contains information about the type, path, handle count of the mounted device. Microsoft-Windows-Sysmon/Operational
- [ ] 4661: A handle to an AD or SAM object was requested. May indicate BloodHound-style LDAP reads. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4661)
- [ ] 4662: Operation on AD object, may indicate enum of domain trusts, OUs, SPNs, ACLs. Also logged when an attacker uses mimikatz or similar to extract the DPAPI Domain Backup Key, allowing them to decrypt every user's DPAPI secrets. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662)
- [ ] 4798: A user's local group membership was enumerated. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4798)
- [ ] 4799: A security-enabled local group membership was enumerated. May be an indicator of attacker enumeration of the Administrators group or similar. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4799)
- [ ] 5142: A network share object was added. May be a prelude to data exfiltration. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5142)
- [ ] 5143: Network share object changed. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5143)
- [ ] 5145: Detailed file share access, includes named pipes and IPC$ (confirm if the client address is external/unexpected). May indicate share enumeration and directory walking prior to exfiltration. The `RelativeTargetName` field may also show the original file name and path on the attacker's machine prior to the file transfer to the target environment! Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5145)
- [ ] 5158: The Windows Filtering Platform has permitted a bind to a local port. Indicates processes that open listening sockets, unexpected binds on high ports may be a prelude to data exfiltration. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5158)
- [ ] 16403: BITS job created. May indicate download/staging. Microsoft-Windows-Bits-Client [Mandiant](https://cloud.google.com/blog/topics/threat-intelligence/attacker-use-of-windows-background-intelligent-transfer-service)
## Credential Theft
- [ ] Sysmon 9: RawAccessRead, may indicate direct disk reads of ntds.dit, SAM, or page files for offline hash extraction. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-9-rawaccessread)
- [ ] 4692: Backup of a user/computer master key to the DC, rarely seen after first logon. Several events may indicate key theft or mass profile creation. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4692)
- [ ] 4695: CryptUnprotectData of an audited blob, pair with 4694 to identify which user accessed encrypted blobs. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4695)
- [ ] 4724: Password reset for another account. May capture successful resets by an attacker. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4724)
- [ ] 4782: The password hash of an account was accessed. May indicate Pass-the-Hash. Legitimate use occurs during AD password migration operations and run under SYSTEM or a dedicated migration account. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4782)
- [ ] 5376: Backup of Credential Manager vault, shows a user exporting stored passwords and keys. Often precedes lateral movement or exfiltration. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5376)
- [ ] 5377: Credential Manager credentials were restored from a backup, may indicate import of stolen vaults from another host. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5377)
- [ ] 5379: Credential Manager credentials were read. Large numbers of reads may indicate automated credential theft. Security [MS Learn](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=5379)
- [ ] 16385: Exposes the DPAPI operations (protect/unprotect) and the calling process. Disabled by default. Microsoft-Windows-Crypto-DPAPI/Debug [Google Security](https://security.googleblog.com/2024/04/detecting-browser-data-theft-using.html)
- [ ] LOLBins NTDS.dit extraction: ntdsutil.exe, diskshadow.exe, esentutl.exe, vssadmin.exe
## Persistence
- [ ] Sysmon 19-21: WMI EventFilter/EventConsumer/Binding, may surface registration of WMI event-based auto-runs that survive reboots. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-19-wmievent-wmieventfilter-activity-detected)
- [ ] 106: A scheduled task was registered (created or updated). Microsoft-Windows-TaskScheduler/Operational
- [ ] 110: A task was triggered to start (based on time, event, user logon, etc). Microsoft-Windows-TaskScheduler/Operational
- [ ] 1033: Generated when an application is installed or uninstalled. Includes the application name and path of the MSI that was used to un/install. Application [MS Learn](https://learn.microsoft.com/en-us/windows/win32/msi/event-logging)
- [ ] 1085: Windows failed to apply the GPO settings. Microsoft-Windows-GroupPolicy [MS Learn](https://learn.microsoft.com/en-us/troubleshoot/windows-server/group-policy/applying-group-policy-troubleshooting-guidance)
- [ ] 2004: User-Mode drivers loaded. Microsoft-Windows-DriverFrameworks-UserMode/Operational
- [ ] 11707: Windows Installer installed an application, describes the installed product, including the product name, version, and the user who executed the installation. Application [MS Learn](https://learn.microsoft.com/en-us/windows/win32/msi/event-logging)
- [ ] 4657: Registry value modified (requires "AuditRegistry/SetValue" SACL). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4657)
- [ ] 4670: Permissions on an object were changed, may detect ACL edits on files, registry, or tokens that grant elevated rights. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4670)
- [ ] 7045: New service installed. Enabled by default. Fields: service name, file path, account name, start type, service type. System
- [ ] 4697: A service was installed. Fields: service name, service file name, **account that requested the installation**, service type, start type. Not enabled by default. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4697)
- [ ] 4698: A scheduled task was created. May also indicate remote creation via relayed SMB/WinRM session, PS cmdlets, DCOM over RPC, WMI, others. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698)
- [ ] 4700: A scheduled task was enabled. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4700)
- [ ] 4702: A scheduled task was updated. May indicate path or trigger edits. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4702)
- [ ] 4720: A user account was created. Unauthorized admin-level accounts are a classic local/domain privilege escalation vector. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4720)
- [ ] 4722: A user account was enabled. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4722)
- [ ] 4726: User account deleted: SID/account with domain, logon ID that requested deletion, SID/account with domain that was deleted, list of user privileges used during deletion. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4726)
- [ ] 4733: A member was removed from a security-enabled local group. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4733)
- [ ] 4737: A security-enabled global group was changed. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4738: User account changed, may capture priv-esc, password changes, or UAC flag changes. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4738)
- [ ] 4739: Domain Policy was changed. Attackers with Domain Admin may weaken password/lockout requirements to speed credential attacks. May precede password spraying or Kerberos ticket forgery. Pair with 4768 and 4771 to scope exploitation. Also a prelude to DCShadow or other directory-level attacks. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4739)
- [ ] 5859: Registration of temporary event consumers, can be used for remote exec. Microsoft-Windows-WMI-Activity/Operational
- [ ] 5861: Registration of permanent event consumers, including full consumer info. These survive reboots. WMI abuse is a classic technique for file-less persistence. Microsoft-Windows-WMI-Activity/Operational
- [ ] 28115: Indicates the addition of a shortcut to the App Resolver Cache, and appears when an application is installed. Microsoft-Windows-Shell-Core/Operational
## Privilege Escalation
- [ ] Sysmon 6: Driver loaded. Check for vulnerable or unsigned drivers (BYOVD). Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-6-driver-loaded)
- [ ] Sysmon 10: Process access (remote-thread injection, credential dumping). Check for DesiredAccess 0x1FFFFF and LSASS. May indicate mimikatz reading LSASS for Pass-the-Hash. Microsoft-Windows-Sysmon/Operational  [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-10-processaccess)
- [ ] Sysmon 12/13: Registry (key or value) has been (created or set). Helpful for detecting writes to Run or Service keys that grant privileged start-up execution.  Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-12-registryevent-object-create-and-delete)
	- `HKLM\System\CurrentControlSet\Services\<service name>\ImagePath` modification is popular for persisting a service.
- [ ] 4611: Trusted logon process registered, may be seen when a process injects into LSASS. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4611)
- [ ] 4673: A privileged service was called. Logs use of SeDebugPrivilege (often precedes scraping memory), SeTcbPrivilege. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4673)
- [ ] 4674: Operation on privileged object. Logs direct interaction with objects that require SeSecurity/SeTakeOwnership, ie, SAM hives. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4674)
- [ ] 4703: A user right was adjusted, generated when token privileges are changed (tracks rights like SeDebugPrivilege, SeLoadDriverPrivilege). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4703)
- [ ] 4704: A user right was assigned, tracks changes to token privileges. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4704)
- [ ] 4706: A new trust was created to a domain. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4706)
- [ ] 4713: Kerberos policy was changed. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4713)
- [ ] 4716: Trusted domain information was modified. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4716)
- [ ] 4717: System security access was granted to an account. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4717)
- [ ] 4725: A user account was disabled. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4725)
- [ ] 4727: A security-enabled global group was created. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4728: Member added to security-enabled global group. May indicate domain-level priv-esc, ie, membership in "Domain Admins". Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4731: A security-enabled local group was created. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4731)
- [ ] 4732: Member added to a security-enabled local group. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4732)
- [ ] 4735: Security-enabled local group changed, indicates changes to local "Administrators" or "Remote Desktop Users". Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4735)
- [ ] 4741: Computer account created, may alert on golden ticket style attacks. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4741)
- [ ] 4742: A computer account was changed. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4742)
- [ ] 4754: A security-enabled universal group was created. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4756: Member added to security-enabled universal group. May capture cross-domain privilege escalation in a multi-forest trust. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4765: SID History was added to an account. Indicates an admin copied the sIDHistory from one account to another, which allows a user to inherit access rights from a previous account. This may be an indicator of DCShadow or similar lateral movement attacks. The event logs Target Account, Source Account, and Subject SID. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4766)
- [ ] 4766: An attempt to add SID History to an account failed. Indicates an admin attempt to copy the sIDHistory from one account to another, which would allow a user to inherit access rights from a previous account. This may be an indicator of DCShadow or similar lateral movement attacks. The event logs Target Account, Source Account, Subject SID, and failure reason. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4766)
- [ ] 4794: An attempt was made to set the Directory Services Restore Mode administrator password. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4794)
- [ ] 4780: The ACL was set on accounts which are members of administrators groups. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4780)
- [ ] 4817: Auditing settings on object were changed. Attackers that wish to suppress object-access logging can clear/replace the global SACL; this will catch it. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4817)
- [ ] 4865: A trusted forest information entry was added. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4865)
- [ ] 4867: A trusted forest information entry was modified. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4867)
- [ ] 4907: Auditing settings on object were changed, captures SACL changes to files, registry keys, and services. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4907)
- [ ] 4964: Special groups assigned to new logon. Detects Domain Admins or other high-value SIDs logging onto non-DC hosts. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-special-logon)
- [ ] 5038: Code integrity check determined that a file does not meet the security requirements to load on the system. May indicate that malware attempted to load an unsigned or tampered driver/system file to inject itself into a critical system process. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5038)
- [ ] 5136/5137/5139: Directory service object modified/created/moved. May indicate high-impact changes in AD, like adding SID history or malicious GPOs. Attribute change to msDS‑AllowedToActOnBehalfOfOtherIdentity is usually suspicious and indicates a Kerberos relay attack. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5136)
- [ ] 5378: The requested credentials delegation was disallowed by policy. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5378)
## Lateral Movement 
- [ ] Parent process: "svchost.exe -k DcomLaunch" -p, child process wsmprovhost.exe. May indicate PS remoting and WinRM, check children. Note that cmdlets will execute within the wsmprovhost.exe process. [Red Canary](https://redcanary.com/blog/threat-detection/lateral-movement-winrm-wmi)
- [ ] Parent process: winrshost.exe. Another common implementation of WinRM lateral movement
- [ ] Parent process: mmc.exe. Might indicate a LOLBin abused by an attacker. [Enigma0x3](https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object)
- [ ] Parent process: WmiPrvSe.exe. Child process may be an attacker-uploaded exe or LOLBin. [CrowdStrike](https://www.crowdstrike.com/en-us/blog/how-to-detect-and-prevent-impackets-wmiexec)
- [ ] Parent process: psexesvc.exe (child of services.exe) and child process cmd.exe. [Praetorian](https://www.praetorian.com/blog/threat-hunting-how-to-detect-psexec)
- [ ] Parent process: dllhost.exe, check children (ie, cmd.exe or powershell.exe). May indicate DCOM remote execution. [MDSec](https://www.mdsec.co.uk/2020/09/i-like-to-move-it-windows-lateral-movement-part-2-dcom) [Specter Ops](https://posts.specterops.io/lateral-movement-abuse-the-power-of-dcom-excel-application-3c016d0d9922)
- [ ] Sysmon 17/18: Named pipe created/connected. May indicate creation of named pipes for C2 or lateral movement. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-17-pipeevent-pipe-created)
- [ ] 4769: Kerberos service ticket request. Tickets for hosts that a user previously hasn't accessed may indicate Pass-the-Ticket or RDP/WMI pivoting. Confirm that the target server is also the host that is contacted, and unusual/vulnerable encryption types (may indicate [S4U2Proxy](https://docs.specterops.io/ghostpack/rubeus/constrained-delegation-abuse)) like RC4. Check for movement between services or SPNs, and unusual service names. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4769)
- [ ] 4778: RDP session reconnected, useful for tracing session re-use. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4778)
- [ ] 4693: Recovery of data protection master key was attempted, may appear when an attacker re‑uses offline profiles or moves tokens between hosts. Correlate with Logon Type 7/9. Security [Trellix](https://www.trellix.com/blogs/research/detecting-credential-stealing-attacks-through-active-in-network-defense) [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4693)
- [ ] 4882: The security permissions for Certificate Services changed. Records changes to a CA ACL, may indicate privilege escalation -- addition of rogue accounts, who may issue trusted certs. Critical for detecting AD CS abuse. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn786423(v=ws.11))
- [ ] 4885: The audit filter for Certificate Services changed. May be a prelude to AD CS abuse, ie, ESC1/ESC5. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn786423(v=ws.11))
- [ ] 4890: The certificate manager settings for Certificate Services changed. May indicate tampering with permissions, enable addition of rogue accounts, issuance of trusted certificates, and impersonate any domain principal. Can also detect AD CS abuse techniques ie ESC1. Legitimate changes originate from built-in CA service accounts, and any Subject SID that isn't `NT AUTHORITY\SYSTEM` or approved service identity indicates unauthorized privilege abuse. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn786423(v=ws.11))
- [ ] 5140: A network share object was accessed. Tracks who is accessing shared folders on the network. Very noisy! Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5140)
## Execution
- [ ] Parent or child process: cmd.exe
- [ ] Parent or child process: powershell.exe
- [ ] Parent process: WmiPrvSe.exe
- [ ] PowerShell transcript:  `C:\Windows\System32\PowerShellTranscript`
- [ ] PowerShell transcript: `C:\Users\Hello\Documents\PowerShellTranscript`
- [ ] PowerShell log when using the PSReadLine module (enabled by default in recent versions): `C:\Users\Hello\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt`, does not log commands from non-interactive scripts, background jobs, remote sessions (unless PSReadLine is manually configured)
- [ ] Prefetch files: `%SystemRoot%\Prefetch` Captures first and last run‑times, run‑count and path of executables (desktop Windows only)
- [ ] ShimCache (AppCompatCache): `SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache` Registry cache indicating prior execution or presence of PE files (persists even when Prefetch disabled)
- [ ] Amcache.hve: `%SystemRoot%\AppCompat\Programs\Amcache.hve` Rich metadata on first execution, SHA‑1, publisher, and driver installs (Windows 8 +)
- [ ] UserAssist keys: `NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist` Counts and last‑run timestamps for GUI‑launched executables (ROT13 encoded)
- [ ] Sysmon 1: Process create. The ProcessGUID artifact is unique across a domain. Includes a file hash. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-1-process-creation)
- [ ] Sysmon 6: Driver loaded. [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-6-driver-loaded)
- [ ] Sysmon 7: Image loaded. Generated when a process loads a DLL into memory, ie, side-loading. Microsoft-Windows-Sysmon/Operational [MS Learn]([MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-7-image-loaded)
- [ ] 6: WSMan session created. Microsoft-Windows-WinRM/Operational
- [ ] 91: WSMan session. Microsoft-Windows-WinRM/Operational
- [ ] 168: WinRM authentication attempt. Microsoft-Windows-WinRM/Operational
- [ ] 169: WinRM authentication success. Microsoft-Windows-WinRM/Operational
- [ ] 400: Engine state changed (None to Available), created each PowerShell host launch. Anchors script block and transcript events to a process. IR-relevant fields include HostApplication (what process initiated the PS script execution), HostID/RunspaceID (unique to single script execution). Windows PowerShell/PowerShell
- [ ] 403: Engine state changed (Available to Stopped), the script is done running. Windows PowerShell/PowerShell
- [ ] 3001: An unsigned driver was attempted to load on the system. Microsoft-Windows-CodeIntegrity/Operational [MS Learn](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/operations/event-id-explanations)
- [ ] 3004: Unsigned (invalid signature) kernel driver load attempt. Microsoft-Windows-CodeIntegrity/Operational [MS Learn](https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/operations/event-id-explanations)
- [ ] 4688: Process Create. May include CLI arguments. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4688)
- [ ] 4103: Module invocation (PS module logging). Security
- [ ] 4104: Script-block logging (records decoded script content). Security
- [ ] 15457: MS SQL Server xp_cmdshell execution. MSSQLSERVER\Application [MS Learn](https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/#:~:text=If%20we%20look%20into%20the,virus%20software)
## Defense Evasion
- [ ] Sysmon 25: Process tampering, detects process herpaderping. Microsoft-Windows-Sysmon/Operational [Write-up](https://jxy-s.github.io/herpaderping) 
- [ ] Sysmon 26: File deleted, may indicate cleanup of a staged payload. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-26-filedeletedetected-file-delete-logged)
- [ ] 104: Event log was cleared. This will show System, Application, and other non-Security logs being cleared. Review the event to identify which one. Security
- [ ] 151: Mass file deletions. Security
- [ ] 1002: An anti-malware scan was stopped before it finished. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1002)
- [ ] 1005: An anti-malware scan failed. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus)
- [ ] 1013: Defender history cleared. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus)
- [ ] 1014: The anti-malware platform could not delete history of malware and other potentially unwanted software. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1014)
- [ ] 1015: The anti-malware platform detected suspicious behavior. Microsoft-Windows-Windows Defender/Operational  [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-1015)
- [ ] 1100: The event logging service has shut down. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-1100)
- [ ] 1102: Security log cleared. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-1102)
- [ ] 4616: The system time changed. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4616)
- [ ] 4729: Member removed from security-enabled global group, may be an effort to slow IR or clean-up after escalation. Security [Ultimate Windows Security](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4729)
- [ ] 4660: An object was deleted (could be filesystem, kernel, or registry object). Doesn't track names, but it is generated only during real deletes (pair with 4663). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4660)
- [ ] 4663: An attempt was made to access an object. May catch mass permission changes or tampering, like removing ACLs from logs and AV databases. Also catches renaming, and may be noisy (pair with 4660). Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4663)
- [ ] 4694: Protection of auditable protected data was attempted, when seen outside of software installation it may indicate payload staging hidden in DPAPI. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4694)
- [ ] 4699: A scheduled task was deleted. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4699)
- [ ] 4715: The audit policy (SACL) on an object was changed. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4715)
- [ ] 4718: System security access was removed from an account. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4718)
- [ ] 4719: System audit policy changed. Attackers often disable auditing to reduce detection. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4719)
- [ ] 4725: A user account was disabled, may be an effort to slow IR. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4725)
- [ ] 4729: A member was removed from a security-enabled global group. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4730: A security-enabled global group was deleted. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4734: A security-enabled local group was deleted. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4734)
- [ ] 4743: A computer account was deleted. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4743)
- [ ] 4757: A member was removed from a security-enabled universal group. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/audit-security-group-management)
- [ ] 4781: The name of an account was changed. Attackers may rename an existing, highly privileged account to blend in. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4781)
- [ ] 4902: The Per-user audit policy table was created. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4902)
- [ ] 4908: Special Groups Logon table modified. Deleting privileged SIDs will prevent `Event ID 4964: special group member logged on` from firing. Also appears at every reboot, so IR can compare boot-time record against later changes. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4908)
- [ ] 4912: Per User Audit Policy was changed. Attackers with admin privileges can reduce logging. If `Changes` is set to `None`, or `Includes Failures` to `No`, this may be an attempt to hide activity. Pair with 4179, 4902, and 4624 to reconstruct a timeline. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4912)
- [ ] 4946: Windows Firewall rule was added. Logs rules that open ports or disable filtering, check for RDP or SMB use. Attackers may add rules to enable implants to communicate with external servers. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4946)
- [ ] 4947: A change has been made to Windows Firewall exception list. A rule was modified. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4947)
- [ ] 4948: A change has been made to Windows Firewall exception list. A rule was deleted. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4948)
- [ ] 4950: A setting was changed in Windows Firewall. Tracks changes to core settings the firewall, such as disabling a profile (domain, private, public), or default block/allow behavior. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4950)
- [ ] 5144: A network share object was deleted. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5144)
- [ ] 5156: Windows Filtering Platform permitted connection. Indicates what process (application path) on the local machine made an outbound connection to a specific destination IP address and port. Helpful for reviewing connections made by a suspect process. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5156)
- [ ] 5001: Defender Antivirus Real-Time Protection feature has been disabled. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-5001)
- [ ] 5007: Windows Defender settings changed. Reveals local or remote attempts to disable real‑time protection or ASR rules. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-5007)
- [ ] 5010: Scanning for malware and other potentially unwanted software is disabled. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-5010)
- [ ] 5012: Scanning for viruses is disabled. Microsoft-Windows-Windows Defender/Operational [MS Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus#event-id-5012)
- [ ] 7036: A service has started, stopped, paused, or resumed. May indicate Defender being stopped: check the first parameter, which would read "Windows Defender Antivirus Service", and the second parameter "stopped".
- [ ] 11724: Removal completed successfully. May indicate malicious app cleanup. MsiInstaller/Application
- [ ] $J: Secure file delete
- [ ] File timestomping
- [ ] Registry timestomping
## Command and Control
- [ ] Sysmon 17: Pipe created. May indicate creation of named pipes for C2 or lateral movement, review PipeName. Microsoft-Windows-Sysmon/Operational  [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-17-pipeevent-pipe-created)
- [ ] Sysmon 22: DNS query. Can reveal domains used by beacons. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-22-dnsevent-dns-query)
## Data Exfiltration
- [ ] Sysmon 15: FileCreamStreamHash, indicates creation of ADS (ie, Zone.Identifier) via browser downloads. Microsoft-Windows-Sysmon/Operational [MS Learn](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-15-filecreatestreamhash)
- [ ] 60: Job stopped. Surfaces Background Intelligent Transfer Service misuse for exfil or downloads. Microsoft-Windows-Bits-Client/Operational
- [ ] 400/410: New Mass Storage Installation. Windows PowerShell
- [ ] 4656: Handle requested on object. Combined with 4663 (An attempt was made to access an object), may reveal bulk reads of sensitive shares before exfil. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4656)
- [ ] 6422: A device was enabled. May indicate removable storage or network adapters to stage tools or exfiltrate data. Security [MS Learn](https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6422)
- [ ] 6115/6117: Windows LiveId sign-in activity. Microsoft‑Windows‑LiveId/Operational

# Uncategorized
- [ ] 4608: Windows is starting up, logged when LSASS.exe starts and the auditing subsystem is initialized. Security
- [ ] 4609: Windows is shutting down. Security
- [ ] 6005: The Event Log service was started. Indicates system boot, and is a reliable indicator for establishing a timeline. System
- [ ] 6006: The Event Log service was started. Indicates system shutdown, and is a reliable indicator for establishing a timeline. An absence of this before 6005 suggests an unexpected shutdown or crash, which may be suspicious. System
